<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Lab: Recursion, Inductive Data Types, and Abstract Syntax Trees – Principles and Practice of Programming Languages</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./recursion.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./expressions.html">Programming Preliminaries</a></li><li class="breadcrumb-item"><a href="./inductive-data-types-lab.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab: Recursion, Inductive Data Types, and Abstract Syntax Trees</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Principles and Practice of Programming Languages</a> 
        <div class="sidebar-tools-main">
    <a href="./Principles-and-Practice-of-Programming-Languages.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./money.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Your Money’s Worth</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./course-approach.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Course Approach</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Programming Preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./expressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Expressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binding-and-scope.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Binding and Scope</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./binding-and-scope-exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exercise: Binding and Scope</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-types-exercise.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exercise: Expressions and Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./recursion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Recursion, Induction, and Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inductive-data-types-lab.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab: Recursion, Inductive Data Types, and Abstract Syntax Trees</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#recursion" id="toc-recursion" class="nav-link active" data-scroll-target="#recursion"><span class="header-section-number">9.1</span> Recursion</a></li>
  <li><a href="#data-structures-review-binary-search-trees" id="toc-data-structures-review-binary-search-trees" class="nav-link" data-scroll-target="#data-structures-review-binary-search-trees"><span class="header-section-number">9.2</span> Data Structures Review: Binary Search Trees</a></li>
  <li><a href="#interpreter-javascripty-calculator" id="toc-interpreter-javascripty-calculator" class="nav-link" data-scroll-target="#interpreter-javascripty-calculator"><span class="header-section-number">9.3</span> Interpreter: JavaScripty Calculator</a></li>
  <li><a href="#submission" id="toc-submission" class="nav-link" data-scroll-target="#submission">Submission</a></li>
  </ul>
<div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="inductive-data-types-lab.ipynb"><i class="bi bi-file-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./expressions.html">Programming Preliminaries</a></li><li class="breadcrumb-item"><a href="./inductive-data-types-lab.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab: Recursion, Inductive Data Types, and Abstract Syntax Trees</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Lab: Recursion, Inductive Data Types, and Abstract Syntax Trees</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">
<!-- 3 Expressions -->
<!-- 4 Binding and Scope -->
<!-- 8 Recursion -->
<!-- 9 Inductive Data Types -->
</div>
<section id="learning-goals" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="learning-goals">Learning Goals</h3>
<p>The primary learning goals of this assignment are to build intuition for the following:</p>
<dl>
<dt>Functional Programming Skills</dt>
<dd>
Representing data structures using algebraic data types.
</dd>
<dt>Programming Languages Ideas</dt>
<dd>
Representing programs as abstract syntax.
</dd>
</dl>
</section>
<section id="instructions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="instructions">Instructions</h3>
<p>A version of project files for this lab resides in the public <a href="https://github.com/csci3155/pppl-lab1">pppl-lab1</a> repository. Please follow separate instructions to get a private clone of this repository for your work.</p>
<p>You will be replacing <code class="sourceCode scala"><span class="op">???</span></code> in the <code>Lab1.scala</code> file with solutions to the coding exercises described below. Make sure that you remove the <code class="sourceCode scala"><span class="op">???</span></code> and replace it with the answer.</p>
<p>You may add additional tests to the <code>Lab1Spec.scala</code> file. In the <code>Lab1Spec.scala</code>, there is empty test class <code>Lab1StudentSpec</code> that you can use to separate your tests from the given tests in the <code>Lab1Spec</code> class. You are also likely to edit <code>Lab1.worksheet.sc</code> for any scratch work.</p>
<p>Single-file notebooks are convenient when experimenting with small bits of code, but they can become unwieldy when one needs a multiple-file project instead. In this case, we use standard build tools (e.g., <code>sbt</code> for Scala), IDEs (e.g., Visual Studio Code with Metals), and source control systems (e.g., <code>git</code> with GitHub).</p>
<p>While it is almost overkill to use these standard software engineering tools for this lab, we get practice using these tools in the small. If you like, you may use this notebook for experimentation before copying code over to your code repository.</p>
</section>
<section id="recursion" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="recursion"><span class="header-section-number">9.1</span> Recursion</h2>
<section id="repeat-string" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="repeat-string"><span class="header-section-number">9.1.1</span> Repeat String</h3>
<div id="exr-repeat" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.1</strong></span> Write a recursive function <code class="sourceCode scala">repeat</code></p>
</div>
<div id="f7013900" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">repeat</span><span class="op">(</span>s<span class="op">:</span> <span class="ex">String</span><span class="op">,</span> n<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span> <span class="ex">String</span> <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">repeat</span></pre>
</div>
</div>
</div>
<p>where <code class="sourceCode scala"><span class="fu">repeat</span><span class="op">(</span>s<span class="op">,</span> n<span class="op">)</span></code> returns a string with <code class="sourceCode scala">n</code> copies of <code class="sourceCode scala">s</code> concatenated together. For example, <code class="sourceCode scala"><span class="fu">repeat</span><span class="op">(</span><span class="st">"a"</span><span class="op">,</span><span class="dv">3</span><span class="op">)</span></code> returns <code class="sourceCode scala"><span class="st">"aaa"</span></code>. Implement by this function by direct recursion. Do not use any Scala library methods.</p>
</section>
<section id="square-root" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="square-root"><span class="header-section-number">9.1.2</span> Square Root</h3>
<p>In this exercise, we will implement the square root function. To do so, we will use Newton’s method (also known as Newton-Raphson).</p>
<p>Recall from Calculus that a root of a differentiable function can be iteratively approximated by following tangent lines. More precisely, let <span class="math inline">\(f\)</span> be a differentiable function, and let <span class="math inline">\(x_0\)</span> be an initial guess for a root of <span class="math inline">\(f\)</span>. Then, Newton’s method specifies a sequence of approximations <span class="math inline">\(x_0, x_1, \ldots\)</span> with the following recursive equation:</p>
<p><span class="math display">\[
x_{n + 1} = x_n - \frac{f(x_n)}{f'(x_n)}
\;.\]</span></p>
<p>The square root of a real number <span class="math inline">\(c\)</span> for <span class="math inline">\(c &gt; 0\)</span>, written <span class="math inline">\(\sqrt{c}\)</span>, is a positive <span class="math inline">\(x\)</span> such that <span class="math inline">\(x^2 = c\)</span>. Thus, to compute the square root of a number <span class="math inline">\(c\)</span>, we want to find the positive root of the function: <span class="math display">\[f(x) = x^2 - c \;.\]</span> Thus, the following recursive equation defines a sequence of approximations for <span class="math inline">\(\sqrt{c}\)</span>: <span class="math display">\[x_{n + 1} = x_n - \frac{x_n^2 - c}{2 x_n} \;.\]</span></p>
<div id="exr-sqrtStep" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.2</strong></span> First, implement a function <code class="sourceCode scala">sqrtStep</code></p>
</div>
<div id="c539e344" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">sqrtStep</span><span class="op">(</span>c<span class="op">:</span> <span class="ex">Double</span><span class="op">,</span> xn<span class="op">:</span> <span class="ex">Double</span><span class="op">):</span> <span class="ex">Double</span> <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">sqrtStep</span></pre>
</div>
</div>
</div>
<p>that takes one step of approximation in computing <span class="math inline">\(\sqrt{c}\)</span> (i.e., computes <span class="math inline">\(x_{n + 1}\)</span> from <span class="math inline">\(x_n\)</span>).</p>
<div id="exr-sqrtN" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.3</strong></span> Next, implement a function <code class="sourceCode scala">sqrtN</code></p>
</div>
<div id="9bb776bd" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">sqrtN</span><span class="op">(</span>c<span class="op">:</span> <span class="ex">Double</span><span class="op">,</span> x0<span class="op">:</span> <span class="ex">Double</span><span class="op">,</span> n<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span> <span class="ex">Double</span> <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">sqrtN</span></pre>
</div>
</div>
</div>
<p>that computes the <span class="math inline">\(n\)</span>th approximation <span class="math inline">\(x_n\)</span> from an initial guess <span class="math inline">\(x_0\)</span>. You will want to call <code class="sourceCode scala">sqrtStep</code> implemented in the previous part.</p>
<p>You need to implement this function using recursion and no mutable variables (i.e., <code class="sourceCode scala"><span class="kw">var</span></code>s)—you will want to use a recursive helper function. It is also quite informative to compare your recursive solution with one using a <code class="sourceCode scala"><span class="cf">while</span></code> loop.</p>
<div id="exr-sqrtErr" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.4</strong></span> Now, implement a function <code class="sourceCode scala">sqrtErr</code></p>
</div>
<div id="5bfde3b8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">sqrtErr</span><span class="op">(</span>c<span class="op">:</span> <span class="ex">Double</span><span class="op">,</span> x0<span class="op">:</span> <span class="ex">Double</span><span class="op">,</span> epsilon<span class="op">:</span> <span class="ex">Double</span><span class="op">):</span> <span class="ex">Double</span> <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">sqrtErr</span></pre>
</div>
</div>
</div>
<p>that is very similar to <code class="sourceCode scala">sqrtN</code> but instead computes approximations <span class="math inline">\(x_n\)</span> until the approximation error is within <span class="math inline">\(\varepsilon\)</span> (<code class="sourceCode scala">epsilon</code>), that is, <span class="math inline">\(|x_n^2 - c| &lt; \varepsilon \;.\)</span> You can use your absolute value function <code class="sourceCode scala">abs</code> implemented in a previous part. A wrapper function <code class="sourceCode scala">sqrt</code> is given in the template that simply calls <code class="sourceCode scala">sqrtErr</code> with a choice of <code class="sourceCode scala">x0</code> and <code class="sourceCode scala">epsilon</code>.</p>
<p>You need to implement this function using recursion, though it is useful to compare your recursive solution to one with a <code class="sourceCode scala"><span class="cf">while</span></code> loop.</p>
</section>
</section>
<section id="data-structures-review-binary-search-trees" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="data-structures-review-binary-search-trees"><span class="header-section-number">9.2</span> Data Structures Review: Binary Search Trees</h2>
<p>In this question, we review implementing operations on binary search trees from Data Structures. Balanced binary search trees are common in standard libraries to implement collections, such as sets or maps. For simplicity, we do not worry about balancing in this question.</p>
<p>Trees are important structures in developing interpreters, so this question is also critical practice in implementing tree manipulations.</p>
<p>A binary search tree is a binary tree that satisfies an ordering invariant. Let <span class="math inline">\(n\)</span> be any node in a binary search tree whose left child is <span class="math inline">\(l\)</span>, data value is <span class="math inline">\(d\)</span>, and right child is <span class="math inline">\(r\)</span>. The ordering invariant is that all of the data values in the subtree rooted at <span class="math inline">\(l\)</span> must be <span class="math inline">\(&lt; d\)</span>, and all of the data values in the subtree rooted at <span class="math inline">\(r\)</span> must be <span class="math inline">\(\geq d\)</span>. We will represent a binary trees containing integer data using the following Scala <code class="sourceCode scala"><span class="cf">case</span> <span class="kw">class</span></code>es:</p>
<div id="d3700708" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sealed</span> <span class="kw">trait</span> Tree</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Empty <span class="kw">extends</span> Tree</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">class</span> <span class="ex">Node</span><span class="op">(</span>l<span class="op">:</span> Tree<span class="op">,</span> d<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> r<span class="op">:</span> Tree<span class="op">)</span> <span class="kw">extends</span> Tree</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">trait</span> <span class="ansi-cyan-fg">Tree</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Empty</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Node</span></pre>
</div>
</div>
</div>
<p>A <code class="sourceCode scala">Tree</code> is either <code class="sourceCode scala">Empty</code> or a <code class="sourceCode scala"><span class="ex">Node</span></code> with left child <code class="sourceCode scala">l</code>, data value <code class="sourceCode scala">d</code>, and right child <code class="sourceCode scala">r</code>.</p>
<p>For this question, we will implement the following four functions.</p>
<div id="exr-repOk" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.5</strong></span> The function <code class="sourceCode scala">repOk</code></p>
</div>
<div id="2d4949ff" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">repOk</span><span class="op">(</span>t<span class="op">:</span> Tree<span class="op">):</span> <span class="ex">Boolean</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">check</span><span class="op">(</span>t<span class="op">:</span> Tree<span class="op">,</span> min<span class="op">:</span> <span class="bu">Int</span><span class="op">,</span> max<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span> <span class="ex">Boolean</span> <span class="op">=</span> t <span class="cf">match</span> <span class="op">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty <span class="op">=&gt;</span> <span class="kw">true</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="ex">Node</span><span class="op">(</span>l<span class="op">,</span> d<span class="op">,</span> r<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">???</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check</span><span class="op">(</span>t<span class="op">,</span> <span class="bu">Int</span><span class="op">.</span>MinValue<span class="op">,</span> <span class="bu">Int</span><span class="op">.</span>MaxValue<span class="op">)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">repOk</span></pre>
</div>
</div>
</div>
<p>checks that an instance of <code class="scal">Tree</code> is valid binary search tree. In other words, it checks using a traversal of the tree the ordering invariant described above. This function is useful for testing your implementation.</p>
<div id="exr-insert" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.6</strong></span> The function <code class="sourceCode scala">insert</code></p>
</div>
<div id="5792d194" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">insert</span><span class="op">(</span>t<span class="op">:</span> Tree<span class="op">,</span> n<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span> Tree <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">insert</span></pre>
</div>
</div>
</div>
<p>inserts an integer into the binary search tree. Observe that the return type of <code class="sourceCode scala">insert</code> is a <code class="sourceCode scala">Tree</code>. This choice suggests a functional style where we construct and return a new output tree that is the input tree <code class="sourceCode scala">t</code> with the additional integer <code class="sourceCode scala">n</code> as opposed to destructively updating the input tree.</p>
<div id="exr-deleteMin" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.7</strong></span> The function <code class="sourceCode scala">deleteMin</code></p>
</div>
<div id="25a13b75" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">deleteMin</span><span class="op">(</span>t<span class="op">:</span> Tree<span class="op">):</span> <span class="op">(</span>Tree<span class="op">,</span> <span class="bu">Int</span><span class="op">)</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span><span class="op">(</span>t <span class="op">!=</span> Empty<span class="op">)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">(</span>t<span class="op">:</span> @unchecked<span class="op">)</span> <span class="cf">match</span> <span class="op">{</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="ex">Node</span><span class="op">(</span>Empty<span class="op">,</span> d<span class="op">,</span> r<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">(</span>r<span class="op">,</span> d<span class="op">)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="ex">Node</span><span class="op">(</span>l<span class="op">,</span> d<span class="op">,</span> r<span class="op">)</span> <span class="op">=&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">val</span> <span class="op">(</span>l1<span class="op">,</span> m<span class="op">)</span> <span class="op">=</span> <span class="fu">deleteMin</span><span class="op">(</span>l<span class="op">)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="op">???</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">deleteMin</span></pre>
</div>
</div>
</div>
<p>deletes the smallest data element in the search tree (i.e., the leftmost node). It returns both the updated tree and the data value of the deleted node. This function is intended as a helper function for the <code class="sourceCode scala">delete</code> function.</p>
<div id="exr-delete" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.8</strong></span> The function <code class="sourceCode scala">delete</code></p>
</div>
<div id="6fe5bb5f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">delete</span><span class="op">(</span>t<span class="op">:</span> Tree<span class="op">,</span> n<span class="op">:</span> <span class="bu">Int</span><span class="op">):</span> Tree <span class="op">=</span> <span class="op">???</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">delete</span></pre>
</div>
</div>
</div>
<p>removes the first node with data value equal to <code class="sourceCode scala">n</code>. This function is trickier than <code class="sourceCode scala">insert</code> because what should be done depends on whether the node to be deleted has children or not. We advise that you take advantage of pattern matching to organize the cases.</p>
</section>
<section id="interpreter-javascripty-calculator" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="interpreter-javascripty-calculator"><span class="header-section-number">9.3</span> Interpreter: JavaScripty Calculator</h2>
<p>In this question, we consider the arithmetic sub-language of JavaScripty (i.e., a basic calculator). We represent the abstract syntax for this sub-language in Scala using the following inductive data type:</p>
<div id="8070062d" class="cell" data-execution_count="11">
<div id="lst-calculator-ast" class="scala cell-code listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-calculator-ast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;9.1: Representing in Scala the abstract syntax of the arithmetic sub-language of JavaScripty (see <code>ast.scala</code>).
</figcaption>
<div aria-describedby="lst-calculator-ast-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="lst-calculator-ast"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="lst-calculator-ast-1"><a href="#lst-calculator-ast-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sealed</span> <span class="kw">trait</span> Expr                                            <span class="co">// e ::=</span></span>
<span id="lst-calculator-ast-2"><a href="#lst-calculator-ast-2" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">class</span> <span class="fu">N</span><span class="op">(</span>n<span class="op">:</span> <span class="ex">Double</span><span class="op">)</span> <span class="kw">extends</span> Expr                         <span class="co">//   n</span></span>
<span id="lst-calculator-ast-3"><a href="#lst-calculator-ast-3" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">class</span> <span class="fu">Unary</span><span class="op">(</span>uop<span class="op">:</span> Uop<span class="op">,</span> e1<span class="op">:</span> Expr<span class="op">)</span> <span class="kw">extends</span> Expr            <span class="co">// | uop e1</span></span>
<span id="lst-calculator-ast-4"><a href="#lst-calculator-ast-4" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">class</span> <span class="fu">Binary</span><span class="op">(</span>bop<span class="op">:</span> Bop<span class="op">,</span> e1<span class="op">:</span> Expr<span class="op">,</span> e2<span class="op">:</span> Expr<span class="op">)</span> <span class="kw">extends</span> Expr <span class="co">// | e1 bop e2</span></span>
<span id="lst-calculator-ast-5"><a href="#lst-calculator-ast-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-calculator-ast-6"><a href="#lst-calculator-ast-6" aria-hidden="true" tabindex="-1"></a><span class="kw">sealed</span> <span class="kw">trait</span> Uop              <span class="co">// uop ::=</span></span>
<span id="lst-calculator-ast-7"><a href="#lst-calculator-ast-7" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Neg <span class="kw">extends</span> Uop   <span class="co">//   -</span></span>
<span id="lst-calculator-ast-8"><a href="#lst-calculator-ast-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="lst-calculator-ast-9"><a href="#lst-calculator-ast-9" aria-hidden="true" tabindex="-1"></a><span class="kw">sealed</span> <span class="kw">trait</span> Bop              <span class="co">// bop ::=</span></span>
<span id="lst-calculator-ast-10"><a href="#lst-calculator-ast-10" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Plus <span class="kw">extends</span> Bop  <span class="co">//   +</span></span>
<span id="lst-calculator-ast-11"><a href="#lst-calculator-ast-11" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Minus <span class="kw">extends</span> Bop <span class="co">// | -</span></span>
<span id="lst-calculator-ast-12"><a href="#lst-calculator-ast-12" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Times <span class="kw">extends</span> Bop <span class="co">// | *</span></span>
<span id="lst-calculator-ast-13"><a href="#lst-calculator-ast-13" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="kw">object</span> Div <span class="kw">extends</span> Bop   <span class="co">// | /</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</figure>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">trait</span> <span class="ansi-cyan-fg">Expr</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">N</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Unary</span>
defined <span class="ansi-green-fg">class</span> <span class="ansi-cyan-fg">Binary</span>
defined <span class="ansi-green-fg">trait</span> <span class="ansi-cyan-fg">Uop</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Neg</span>
defined <span class="ansi-green-fg">trait</span> <span class="ansi-cyan-fg">Bop</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Plus</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Minus</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Times</span>
defined <span class="ansi-green-fg">object</span> <span class="ansi-cyan-fg">Div</span></pre>
</div>
</div>
</div>
<p>In comments, we give a grammar that connects the abstract syntax with the concrete syntax of the language. We consider grammars in more detail subsequently<span class="hidden">in <span class="quarto-unresolved-ref">?sec-grammars</span></span>. For now, it is fine to ignore the concrete syntax or use your intuition for the connection. ow, given the inductive data type <code class="sourceCode scala">Expr</code> defining the abstract syntax:</p>
<div id="exr-calculator-eval" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9.9</strong></span> Implement the <code class="sourceCode scala">eval</code> function</p>
</div>
<div id="054fca87" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">eval</span><span class="op">(</span>e<span class="op">:</span> Expr<span class="op">):</span> <span class="ex">Double</span> <span class="op">=</span> e <span class="cf">match</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="fu">N</span><span class="op">(</span>n<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">???</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> _  <span class="op">=&gt;</span> <span class="op">???</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">eval</span></pre>
</div>
</div>
</div>
<p>that evaluates the Scala representation of a JavaScripty expression <code class="sourceCode scala">e</code> to the Scala double-precision floating point number corresponding to the Scala representation of the JavaScripty <em>value</em> of <code class="sourceCode scala">e</code>. At this point, you have implemented your first language interpreter!</p>
<p>To go in more detail, consider a JavaScripty expression <span class="math inline">\(e\)</span>, and imagine <span class="math inline">\(e\)</span> to be concrete syntax. This text is parsed into a JavaScripty AST <code class="sourceCode scala">e</code>, that is, a Scala value of type <code class="sourceCode scala">Expr</code>. Then, the result of <code class="sourceCode scala">eval</code> is a Scala number of type <code class="sourceCode scala"><span class="ex">Double</span></code> and should match the interpretation of <span class="math inline">\(e\)</span> as a JavaScript expression. These distinctions can be subtle but learning to distinguish between them will go a long way in making sense of programming languages.</p>
<p>To see what a JavaScripty expression <span class="math inline">\(e\)</span> should evaluate to, you may want to run <span class="math inline">\(e\)</span> through a JavaScript interpreter to see what the value should be. For example,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" data-startfrom="229" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 228;"><span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" data-startfrom="233" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 232;"><span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">/</span> <span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-startfrom="237" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 236;"><span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">*</span> <span class="dv">4</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<section id="experiment-in-a-worksheet" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="experiment-in-a-worksheet">Experiment in a Worksheet</h3>
<p>Scala worksheets provide an interactive interface in the context of a multi-file project. A worksheet is a good place to start for experimenting with an implementation, whether on existing code or code that you are in the process of writing. A scratch worksheet <code>Lab1.worksheet.sc</code> is provided for you in the code repository.</p>
<p>To test and experiment with your <code class="sourceCode scala">eval</code> function, you can write JavaScripty expressions directly in abstract syntax like above. You can also make use of a parser that is provided for you: it reads in a JavaScripty program-as-a-<code class="sourceCode scala"><span class="ex">String</span></code> and converts into an abstract syntax tree of type <code class="sourceCode scala">Expr</code>.</p>
<p>For your convenience, we have also provided in the template <code>Lab1.scala</code> file, an overloaded <code class="sourceCode scala">eval<span class="op">:</span> <span class="ex">String</span> <span class="op">=&gt;</span> <span class="ex">Double</span></code> function that calls the provided parser and then delegates to your <code class="sourceCode scala">eval<span class="op">:</span> Expr <span class="op">=&gt;</span> <span class="ex">Double</span></code> function.</p>
</section>
<section id="test-driven-development-and-regression-testing" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="test-driven-development-and-regression-testing">Test-Driven Development and Regression Testing</h3>
<p>Once you have experimented enough in your worksheet to have some tests, it is useful to save those tests to run over-and-over again as you work on your implementation. The idea behind test-driven development is that we first write a test for what we expect our implementation to do. Initially, we expect our implementation to fail the test, and then we work on our implementation until the test succeeds. IDEs have features to support this workflow. While a test suite can never be exhaustive, we have provided a number of initial tests for you in <code>Lab1Spec.scala</code> to partially drive your test-driven development of the functions in this assignment.</p>
</section>
<section id="additional-notes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="additional-notes">Additional Notes</h3>
<p>While you may not need them in this assignment, the <code>ast.scala</code> file also includes some basic helper functions for working with the AST, such as</p>
<div id="3ec9b583" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">isValue</span><span class="op">(</span>e<span class="op">:</span> Expr<span class="op">):</span> <span class="ex">Boolean</span> <span class="op">=</span> e <span class="cf">match</span> <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="fu">N</span><span class="op">(</span>_<span class="op">)</span> <span class="op">=&gt;</span> <span class="kw">true</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> _ <span class="op">=&gt;</span> <span class="kw">false</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> e_minus4_2 <span class="op">=</span> <span class="fu">N</span><span class="op">(-</span><span class="fl">4.2</span><span class="op">)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">isValue</span><span class="op">(</span>e_minus4_2<span class="op">)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="kw">val</span> e_neg_4_2 <span class="op">=</span> <span class="fu">Unary</span><span class="op">(</span>Neg<span class="op">,</span> <span class="fu">N</span><span class="op">(</span><span class="fl">4.2</span><span class="op">))</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">isValue</span><span class="op">(</span>e_neg_4_2<span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">isValue</span>
<span class="ansi-cyan-fg">e_minus4_2</span>: <span class="ansi-green-fg">N</span> = <span class="ansi-yellow-fg">N</span>(n = <span class="ansi-green-fg">-4.2</span>)
<span class="ansi-cyan-fg">res12_2</span>: <span class="ansi-green-fg">Boolean</span> = true
<span class="ansi-cyan-fg">e_neg_4_2</span>: <span class="ansi-green-fg">Unary</span> = <span class="ansi-yellow-fg">Unary</span>(uop = Neg, e1 = <span class="ansi-yellow-fg">N</span>(n = <span class="ansi-green-fg">4.2</span>))
<span class="ansi-cyan-fg">res12_4</span>: <span class="ansi-green-fg">Boolean</span> = false</pre>
</div>
</div>
</div>
<p>the defines which expressions are values. In this case, literal number expressions <code class="sourceCode scala"><span class="fu">N</span><span class="op">(</span></code> <span class="math inline">\(n\)</span> <code class="sourceCode scala"><span class="op">)</span></code> are values where <span class="math inline">\(n\)</span> is the meta-variable for JavaScripty numbers. We represent JavaScripty numbers in Scala with Scala values of type <code class="sourceCode scala"><span class="ex">Double</span></code>.</p>
<p>We also define functions to pretty-print, that is, convert abstract syntax to concrete syntax:</p>
<div id="769e512d" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">prettyNumber</span><span class="op">(</span>n<span class="op">:</span> <span class="ex">Double</span><span class="op">):</span> <span class="ex">String</span> <span class="op">=</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>n<span class="op">.</span>isWhole<span class="op">)</span> <span class="st">"%.0f"</span> format n <span class="cf">else</span> n<span class="op">.</span>toString</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">pretty</span><span class="op">(</span>v<span class="op">:</span> Expr<span class="op">):</span> <span class="ex">String</span> <span class="op">=</span> <span class="op">{</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span><span class="op">(</span><span class="fu">isValue</span><span class="op">(</span>v<span class="op">))</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">(</span>v<span class="op">:</span> @unchecked<span class="op">)</span> <span class="cf">match</span> <span class="op">{</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">N</span><span class="op">(</span>n<span class="op">)</span> <span class="op">=&gt;</span> <span class="fu">prettyNumber</span><span class="op">(</span>n<span class="op">)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty</span><span class="op">(</span><span class="fu">N</span><span class="op">(</span><span class="fl">4.2</span><span class="op">))</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">pretty</span><span class="op">(</span><span class="fu">N</span><span class="op">(</span><span class="dv">10</span><span class="op">))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div class="ansi-escaped-output">
<pre>defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">prettyNumber</span>
defined <span class="ansi-green-fg">function</span> <span class="ansi-cyan-fg">pretty</span>
<span class="ansi-cyan-fg">res13_2</span>: <span class="ansi-green-fg">String</span> = <span class="ansi-green-fg">"4.2"</span>
<span class="ansi-cyan-fg">res13_3</span>: <span class="ansi-green-fg">String</span> = <span class="ansi-green-fg">"10"</span></pre>
</div>
</div>
</div>
<p>We only define <code>pretty</code> for values, and we do not override the <code>toString</code> method so that the abstract syntax can be printed as-is.</p>
<div id="222fbd39" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode scala code-with-copy"><code class="sourceCode scala"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>e_minus4_2<span class="op">.</span>toString</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>e_neg_4_2<span class="op">.</span>toString</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div class="ansi-escaped-output">
<pre><span class="ansi-cyan-fg">res14_0</span>: <span class="ansi-green-fg">String</span> = <span class="ansi-green-fg">"N(-4.2)"</span>
<span class="ansi-cyan-fg">res14_1</span>: <span class="ansi-green-fg">String</span> = <span class="ansi-green-fg">"Unary(Neg,N(4.2))"</span></pre>
</div>
</div>
</div>
<p>The <code class="sourceCode scala">@unchecked</code> annotation tells the Scala compiler that we know the pattern match is non-exhaustive syntactically, so we do not want to be warned about it. However, we see that our definition of <code>isValue</code> rules out the potential for a match error at run time (right?).</p>
</section>
</section>
<section id="submission" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="submission">Submission</h2>
<p>If you are a University of Colorado Boulder student, we use Gradescope for assignment submission. In summary,</p>
<ul class="task-list">
<li><label><input type="checkbox">Create a private GitHub repository by clicking on a GitHub Classroom link from the corresponding Canvas assignment entry.</label></li>
<li><label><input type="checkbox">Clone your private GitHub repository to your development environment (using the <code>&lt;&gt; Code</code> button on GitHub to get the repository URL).</label></li>
<li><label><input type="checkbox">Work on this lab from your cloned repository. Use Git to save versions on GitHub (e.g., <code>git add</code>, <code>git commit</code>, <code>git push</code> on the command line or via VSCode).</label></li>
<li><label><input type="checkbox">Submit to the corresponding Gradescope assignment entry for grading by choosing GitHub as the submission method.</label></li>
</ul>
<p>You need to have a GitHub identity and must have your full name in your GitHub profile in case we need to associate you with your submissions.</p>


</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IjMgKyA0XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIxIC8gN1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiNiAqIDQgLSAyICsgMTBcbiJ9XX0=
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./recursion.html" class="pagination-link" aria-label="Recursion, Induction, and Iteration">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Recursion, Induction, and Iteration</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>